SELECT 
CASE 
WHEN CV.cuenta IN ('510560','520560','51054503','510548','52054503','520548') OR
cuenta BETWEEN '510503' AND '510527' OR
cuenta BETWEEN '520503' AND '520527'

THEN 5001 
WHEN CV.cuenta BETWEEN '5110' AND '5110zzz' THEN 5002
WHEN cuenta BETWEEN '5135' AND '5135ZZZ' OR
cuenta BETWEEN '5145' AND '5145ZZZ' OR
cuenta BETWEEN '5150' AND '5150ZZZ' OR
cuenta BETWEEN '5235' AND '5235ZZZ' OR
cuenta BETWEEN '5245' AND '5245ZZZ' THEN 5004
WHEN CV.cuenta BETWEEN '5120' AND '5120ZZZ' THEN 5005
WHEN CV.cuenta IN ('530525','530520') THEN 5006 
WHEN CV.cuenta IN ('530505','530515','530535','531015','539525','531515','531520','539520') THEN 5013
WHEN cuenta BETWEEN '5115' AND '5115ZZZ' OR
cuenta BETWEEN '5215' AND '5215ZZZ' THEN 5015
WHEN (CV.cuenta IN ('510551','510563','512510','520551','520563') OR  
cuenta BETWEEN '510595' AND '510595ZZZ' OR
cuenta BETWEEN '5130' AND '5130ZZZ' OR
cuenta BETWEEN '5140' AND '5140ZZZ' OR
cuenta BETWEEN '5155' AND '5155ZZZ' OR
cuenta BETWEEN '5195' AND '5195ZZZ' OR
cuenta BETWEEN '520595' AND '520595ZZZ' OR
cuenta BETWEEN '5255' AND '5255ZZZ' OR
cuenta BETWEEN '5295' AND '5295ZZZZZ') AND cuenta NOT IN ('519520') THEN 5016 
WHEN CV.cuenta IN ('519520','529520') THEN 5055 
WHEN CV.cuenta IN ('512505') THEN 5058
WHEN CV.cuenta IN ('531595') THEN 50131
ELSE 0 END CONCEPTO,

T.nit_real,ROUND(SUM(CV.saldo_inicial+CV.debito-CV.credito),0) VALOR
FROM cuentas_val CV INNER JOIN terceros T ON (CV.nit=T.nit)
WHERE CV.ano=2016 AND CV.mes=12 AND 

(cuenta IN ('510560','520560','530525','530520','530505','530515','530535','531015','539525','531515','531520','539520','510551','510563',
'512510','520551','520563','519520','529520','512505','531595','51054503','510548','520548','52054503') OR
cuenta BETWEEN '5110' AND '5110zzz' OR
cuenta BETWEEN '5135' AND '5135ZZZ' OR
cuenta BETWEEN '5145' AND '5145ZZZ' OR
cuenta BETWEEN '5150' AND '5150ZZZ' OR
cuenta BETWEEN '5235' AND '5235ZZZ' OR
cuenta BETWEEN '5245' AND '5245ZZZ' OR
cuenta BETWEEN '5120' AND '5120ZZZ' OR
cuenta BETWEEN '5115' AND '5115ZZZ' OR
cuenta BETWEEN '5215' AND '5215ZZZ' OR
cuenta BETWEEN '510595' AND '510595ZZZ' OR
cuenta BETWEEN '5130' AND '5130ZZZ' OR
cuenta BETWEEN '5140' AND '5140ZZZ' OR
cuenta BETWEEN '5155' AND '5155ZZZ' OR
cuenta BETWEEN '5195' AND '5195ZZZ' OR
cuenta BETWEEN '520595' AND '520595ZZZ' OR
cuenta BETWEEN '5255' AND '5255ZZZ' OR
cuenta BETWEEN '529535' AND '5295ZZZZZ' or
cuenta BETWEEN '510503' AND '510527' OR
cuenta BETWEEN '520503' AND '520527' )
GROUP BY T.nit_real,CV.cuenta
HAVING ROUND(SUM(CV.saldo_inicial+CV.debito-CV.credito),0)<>0
UNION
SELECT 5001 CONCEPTO,T.nit_real NIT,SUM(M.valor) VALOR
FROM movimiento M 
INNER JOIN terceros T ON (M.nit=T.nit)
WHERE YEAR(M.fec)=2016 AND M.tipo IN ('EG','NOM') AND M.cuenta IN ('251010','252002','251501','252503')
GROUP BY T.nit_real
HAVING SUM(M.valor)<>0

UNION

SELECT 5001 CONCEPTO,T.nit_real NIT,SUM(M.valor) VALOR
FROM movimiento M 
INNER JOIN terceros T ON (M.nit=T.nit)
WHERE YEAR(M.fec)=2016 AND M.tipo IN ('EG','NOM') AND M.cuenta IN ('251010','252002','251501','252503') AND NOT (M.tipo='EG' AND M.numero=665) AND M.valor>0
GROUP BY T.nit_real
HAVING SUM(M.valor)<>0

